specVersion: 1.0.0
indexerHints:
  prune: auto

schema:
  file: ./schema.graphql

dataSources:
  - kind: ethereum
    name: Modular4337Factory
    network: arbitrum
    source:
      address: "0x0e16a3A01c54a79b692DC58c891BF9d8c0b18FA9"
      abi: Modular4337Factory
      startBlock: 327730138
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - AccountDeployed
        - VaultAdded
        - VaultRemoved
        - WalletOwnershipSet
      abis:
        - name: Modular4337Factory
          file: ./abis/Modular4337Factory.json
        - name: CamelotLiquidityManager
          file: ./abis/CamelotLiquidityManager.json
      eventHandlers:
        - event: AccountDeployed(indexed address,address,bytes32)
          handler: handleAccountDeployed
        - event: VaultAdded(indexed address)
          handler: handleVaultAdded
        - event: VaultRemoved(indexed address)
          handler: handleVaultRemoved
      file: ./src/modular-4337-factory.ts

templates:
  - name: CamelotLiquidityManager
    kind: ethereum/contract
    network: arbitrum
    source:
      abi: CamelotLiquidityManager
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.7
      language: wasm/assemblyscript
      entities:
        - CamelotLiquidityManager
        - UserAccount
        - Policy
        - Vault
        - VaultDeposit
        - Position
        - TreasuryUpdate
        - TokenPairUpdate
        - AmountLimitsUpdate
      abis:
        - name: CamelotLiquidityManager
          file: ./abis/CamelotLiquidityManager.json
      eventHandlers:
        - event: Minted(uint256,uint128)
          handler: handleMinted
        - event: Burned(uint256,uint256,uint256)
          handler: handleBurned
        - event: LiquidityIncreased(uint256,uint128,uint256,uint256)
          handler: handleLiquidityIncreased
        - event: LiquidityDecreased(uint256,uint128,uint256,uint256)
          handler: handleLiquidityDecreased
        - event: Rebalanced(uint256,uint256,uint128)
          handler: handleRebalanced
        - event: CollectFee(uint256,uint256,uint256)
          handler: handleCollectFee
        - event: TreasuryUpdated(address,uint256)
          handler: handleTreasuryUpdated
        - event: TokenPairUpdated(address,address)
          handler: handleTokenPairUpdated
        - event: AmountLimitsUpdated(uint256,uint256,uint256,uint256)
          handler: handleAmountLimitsUpdated
      file: ./src/CamelotLiquidityManager.ts
